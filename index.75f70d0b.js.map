{"mappings":"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","sources":["src/js/movie-details.js"],"sourcesContent":["import axios from 'axios';\nimport { idToGenereTranslate, modalToggle } from './helpers';\n\nconst gallery = document.querySelector('.movie-container');\nconst overview = document.querySelector('.overview');\nconst closeModal = document.querySelector('.modalClose');\nconst API_KEY = '4e9fa3fc2487236fdff94602c5bb9552';\n\nconst watchButton = document.querySelector('.watch');\nconst queueButton = document.querySelector('.que');\n\nconst spinner = document.querySelector('.sk-chase');\nlet exportData;\n\ncloseModal.onclick = modalToggle;\n\nconst fetchProvider = async (id = 1771) => {\n  const table = await axios.get(\n    `\nhttps://api.themoviedb.org/3/movie/${id}/watch/providers?api_key=4e9fa3fc2487236fdff94602c5bb9552`,\n  );\n  console.log(table);\n  return table;\n};\n\nconst fetchGenere = async q => {\n  const table = await axios.get(\n    `\nhttps://youtube.googleapis.com/youtube/v3/search?q=${q}&key=AIzaSyB8TTc_5353cPL4Gqfo9xPQBbRH9hfG-YA`,\n  );\n  return table;\n};\n\nfunction gatherDetailsProv(response) {\n  const table = response.data.results.PL;\n  console.log('test');\n  if (table !== undefined && table.flatrate !== undefined) {\n    // console.log(table.flatrate[0].provider_name.includes === \"Netflix\")\n    console.log(table.flatrate[0].provider_name === 'Netflix');\n    const NMark = `<a href=\"https://www.netflix.com/search?q=${exportData.title}\" target=\"_blank\" rel=\"noreferrer noopener\"><image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${table.flatrate[0].logo_path}\" width=\"50\" height=\"50\"></a>   \n   `;\n\n    const markupList = table.flatrate\n      .filter(image => image.provider_name !== 'Netflix')\n      .map(\n        image => `<image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${image.logo_path}\" width=\"50\" height=\"50\">   \n   `,\n      )\n      .join(``);\n    overview.insertAdjacentHTML('beforeend', `<p class=\"mod-ab\">STREAM</p>`);\n    if (table.flatrate[0].provider_name === 'Netflix') {\n      overview.insertAdjacentHTML('beforeend', NMark);\n    }\n    overview.insertAdjacentHTML('beforeend', markupList);\n    document.querySelector('.mod--buttons').classList.remove('mod--buttons-alt');\n  } else {\n    document.querySelector('.mod--buttons').classList.add('mod--buttons-alt');\n  }\n}\n\nfunction gatherDetailsForYt(response) {\n  const table = response.data;\n  detailsObjectYouTube = {\n    snipet: table.items[0].id.videoId,\n  };\n  console.log(detailsObjectYouTube);\n}\n\nvar vplayer = document.querySelectorAll('.vplayer');\n\nfunction YoutubeLoad(q) {\n  var vplayer = document.querySelectorAll('.vplayer');\n\n  for (var i = 0; i < vplayer.length; i++) {\n    // console.log(vplayer[i].dataset.v);\n    var source = 'https://img.youtube.com/vi/' + q + '/sddefault.jpg';\n\n    var image = new Image();\n    image.src = source;\n    image.addEventListener(\n      'load',\n      (function () {\n        vplayer[i].appendChild(image);\n      })(i),\n    );\n\n    function LoadYT() {\n      var iframe = document.createElement('iframe');\n      iframe.setAttribute('allowfullscreen', '');\n      iframe.setAttribute('frameborder', '0');\n      iframe.setAttribute('src', 'https://www.youtube.com/embed/' + q + '?rel=0&showinfo=0');\n      vplayer[i].innerHTML = '';\n      vplayer[i].appendChild(iframe);\n    }\n    LoadYT();\n  }\n}\n\n// Zapytanie do API TMDB zwraca obiekt odpowiedzi\nconst fetchDetails = async (id = 1771) => {\n  spinner.classList.remove('hidden');\n  const table = await axios.get(`\n\nhttps://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=en-US`);\n  return table;\n};\n\n// Renderowanie zawartości modala\nfunction renderDetails(response) {\n  const table = response.data;\n  exportData = response.data;\n  console.log(table);\n\n  const markupList = `<div class=\"mod-div-img\"><image class=\"mod-img\" src=\"https://image.tmdb.org/t/p/w500${\n    table.poster_path\n  }\"><div><h2 class=\"mod-title\">${table.title.toUpperCase()}</h2>\n  <div class=\"row\">\n<div class = \"columnA\">\n  <p class=\"space\">Vote / Votes</p>\n  <p class=\"space\">Popularity</p>\n  <p class=\"space\">Original Title</p>\n  <p class=\"space\">Genre</p>\n  </div>\n     <div class = \"columnB\">\n     <p class=\"space\"><span class=\"vote-mod\">${table.vote_average.toFixed(\n       1,\n     )}</span> / <span class=\"votes-mod\">${table.vote_count}</p>\n     <p class=\"space\">${table.popularity.toFixed(1)}</p></b>\n     <p class=\"space\">${table.original_title.toUpperCase()}</p>\n     <p class=\"space\">${table.genres.map(element => idToGenereTranslate(element.id)).join(`, `)}  \n     </p> \n     </div></div>  \n  <h3 class=\"mod-about\">ABOUT</h3>\n      <p class=\"mod-about-content\">${table.overview}</p>\n  `;\n  overview.insertAdjacentHTML(\n    'afterbegin',\n    markupList.replaceAll(\n      'https://image.tmdb.org/t/p/w500null',\n      'https://mateuszwoj-bit.github.io/GOIT-team-project-ice/squoosh-how1-desktop.b9f13a59.png',\n    ),\n  );\n  spinner.classList.add('hidden');\n}\n\n//Pobiera informacje z atrybutów plakatu filmu (IMG)\nfunction handleDetailClick(event) {\n  console.log(event.target.getAttribute('movieID'));\n  console.log(event.target.getAttribute('movietitle'));\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  overview.innerHTML = '';\n  modalToggle();\n  fetchDetails(event.target.getAttribute('movieID'))\n    .then(function (response) {\n      // handle success\n      renderDetails(response);\n      watchButton.innerHTML = 'ADD TO WATCHED';\n      watchButton.classList.remove('btn-mod-color');\n      queueButton.innerHTML = 'ADD TO QUEUE';\n      queueButton.classList.remove('btn-mod-color');\n      console.log(exportData.title);\n      const parsedWatch = JSON.parse(localStorage.getItem('WATCH_KEY'));\n      const parsedQue = JSON.parse(localStorage.getItem('QUEUE_KEY'));\n     if (\n       (Array.isArray(parsedWatch) && parsedWatch.length) ||\n       (Array.isArray(parsedQue) && parsedQue.length)\n     ) {\n       if (parsedWatch && parsedWatch.length && exportData.title) {\n         const watchedMovie = parsedWatch.find(\n           movie => movie.title === exportData.title\n         );\n         if (watchedMovie) {\n           watchButton.innerHTML = 'ADDED TO WATCHED';\n           watchButton.classList.add('btn-mod-color');\n         }\n       }\n       if (parsedQue && parsedQue.length && exportData.title) {\n         const queueMovie = parsedQue.find(\n           movie => movie.title === exportData.title\n         );\n         if (queueMovie) {\n           queueButton.innerHTML = 'ADDED TO QUEUE';\n           queueButton.classList.add('btn-mod-color');\n         }\n       }\n     }\n    })\n    .then(\n      fetchProvider(event.target.getAttribute('movieID'))\n        .then(function (response) {\n          // handle success\n          console.log('prov');\n          console.log(response);\n          gatherDetailsProv(response);\n        })\n        .catch(function (error) {\n          // handle error\n          console.log(error);\n        }),\n    )\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n  fetchGenere(event.target.getAttribute('movietitle'))\n    .then(function (response) {\n      // handle success\n      console.log(response);\n      console.log(response.data.items[0].id.videoId);\n      gatherDetailsForYt(response);\n      YoutubeLoad(response.data.items[0].id.videoId);\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n}\n\ngallery.onclick = handleDetailClick;\nexport { exportData };\n"],"names":["$fmRoT","parcelRequire","$d12d61fe1941ad07$var$gallery","document","querySelector","$d12d61fe1941ad07$var$overview","$d12d61fe1941ad07$var$closeModal","$d12d61fe1941ad07$var$watchButton","$d12d61fe1941ad07$var$queueButton","$d12d61fe1941ad07$var$spinner","$d12d61fe1941ad07$export$5e3bc6f9d5e187a3","onclick","$ge6e3","modalToggle","querySelectorAll","event","console","log","target","getAttribute","nodeName","innerHTML","async","id","classList","remove","default","get","$d12d61fe1941ad07$var$fetchDetails","then","response","table","data","markupList","poster_path","title","toUpperCase","vote_average","toFixed","vote_count","popularity","original_title","genres","map","element","idToGenereTranslate","join","overview","insertAdjacentHTML","replaceAll","add","$d12d61fe1941ad07$var$renderDetails","parsedWatch","JSON","parse","localStorage","getItem","parsedQue","Array","isArray","length","find","movie","$d12d61fe1941ad07$var$fetchProvider","results","PL","undefined","flatrate","provider_name","NMark","logo_path","filter","image","$d12d61fe1941ad07$var$gatherDetailsProv","catch","error","q","$d12d61fe1941ad07$var$fetchGenere","items","videoId","detailsObjectYouTube","snipet","$d12d61fe1941ad07$var$gatherDetailsForYt","iframe","vplayer","i","source","Image","src","addEventListener","appendChild","createElement","setAttribute","$d12d61fe1941ad07$var$YoutubeLoad"],"version":3,"file":"index.75f70d0b.js.map"}