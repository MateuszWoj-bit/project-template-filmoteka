{"mappings":"4nBAAA,IAAAA,EAAAC,EAAA,S,aAGA,MAAMC,EAAUC,SAASC,cAAc,oBACjCC,EAAWF,SAASC,cAAc,aAClCE,EAAaH,SAASC,cAAc,eAGpCG,EAAcJ,SAASC,cAAc,UACrCI,EAAcL,SAASC,cAAc,QAErCK,EAAUN,SAASC,cAAc,aACvC,IAAIM,EAEJJ,EAAWK,QAAUC,EAAAC,YAsDPV,SAASW,iBAAiB,YAyIxCZ,EAAQS,QA3DR,SAA2BI,GACzBC,QAAQC,IAAIF,EAAMG,OAAOC,aAAa,YACtCH,QAAQC,IAAIF,EAAMG,OAAOC,aAAa,eACR,QAA1BJ,EAAMG,OAAOE,WAGjBf,EAASgB,UAAY,IACrB,EAAAT,EAAAC,eAtDmBS,OAAOC,EAAK,QAC/Bd,EAAQe,UAAUC,OAAO,gBACLzB,EAAA0B,QAAMC,IAAI,0CAEKJ,8DAmDnCK,CAAab,EAAMG,OAAOC,aAAa,YACpCU,MAAK,SAAUC,IA/CpB,SAAuBA,GACrB,MAAMC,EAAQD,EAASE,KACvBtB,EAAaoB,EAASE,KACtBhB,QAAQC,IAAIc,GAEZ,MAAME,EAAa,uFACjBF,EAAMG,2CACwBH,EAAMI,MAAMC,uSASCL,EAAMM,aAAaC,QAC3D,uCACoCP,EAAMQ,yCACzBR,EAAMS,WAAWF,QAAQ,qCACzBP,EAAMU,eAAeL,4CACrBL,EAAMW,OAAOC,KAAIC,IAAW,EAAAhC,EAAAiC,qBAAoBD,EAAQrB,MAAKuB,KAAK,oHAIrDf,EAAMgB,mBAEzC1C,EAAS2C,mBACP,aACAf,EAAWgB,WACT,sCACA,6FAGJxC,EAAQe,UAAU0B,IAAI,SACxB,CAcMC,CAAcrB,GACdvB,EAAYc,UAAY,iBACxBd,EAAYiB,UAAUC,OAAO,iBAC7BjB,EAAYa,UAAY,eACxBb,EAAYgB,UAAUC,OAAO,iBAC7BT,QAAQC,IAAIP,EAAWyB,OACvB,MAAMiB,EAAcC,KAAKC,MAAMC,aAAaC,QAAQ,cAC9CC,EAAYJ,KAAKC,MAAMC,aAAaC,QAAQ,cAC9CJ,EAAYM,MAAKC,GAASA,EAAMxB,QAAUzB,EAAWyB,UACvD5B,EAAYc,UAAY,mBACxBd,EAAYiB,UAAU0B,IAAI,kBAExBO,EAAUC,MAAKC,GAASA,EAAMxB,QAAUzB,EAAWyB,UACrD3B,EAAYa,UAAY,iBACxBb,EAAYgB,UAAU0B,IAAI,iBAE9B,IACCrB,KA9JiBP,OAAOC,EAAK,QAChC,MAAMQ,QAAc/B,EAAA0B,QAAMC,IACxB,wCACiCJ,8DAGnC,OADAP,QAAQC,IAAIc,GACLA,CAAA,EAyJH6B,CAAc7C,EAAMG,OAAOC,aAAa,YACrCU,MAAK,SAAUC,GAEdd,QAAQC,IAAI,QACZD,QAAQC,IAAIa,GAlJtB,SAA2BA,GACzB,MAAMC,EAAQD,EAASE,KAAK6B,QAAQC,GAEpC,GADA9C,QAAQC,IAAI,aACE8C,IAAVhC,QAA0CgC,IAAnBhC,EAAMiC,SAAwB,CAEvDhD,QAAQC,IAAwC,YAApCc,EAAMiC,SAAS,GAAGC,eAC9B,MAAMC,EAAQ,6CAA6CxD,EAAWyB,sHAAsHJ,EAAMiC,SAAS,GAAGG,iDAGxMlC,EAAaF,EAAMiC,SACtBI,QAAOC,GAAiC,YAAxBA,EAAMJ,gBACtBtB,KACC0B,GAAS,qEAAqEA,EAAMF,+CAGrFrB,KAAK,IACRzC,EAAS2C,mBAAmB,YAAa,gCACD,YAApCjB,EAAMiC,SAAS,GAAGC,eACpB5D,EAAS2C,mBAAmB,YAAakB,GAE3C7D,EAAS2C,mBAAmB,YAAaf,GACzC9B,SAASC,cAAc,iBAAiBoB,UAAUC,OAAO,mBAC3D,MACEtB,SAASC,cAAc,iBAAiBoB,UAAU0B,IAAI,mBAE1D,CA0HUoB,CAAkBxC,EACpB,IACCyC,OAAM,SAAUC,GAEfxD,QAAQC,IAAIuD,EACd,KAEHD,OAAM,SAAUC,GAEfxD,QAAQC,IAAIuD,EACd,IArKgBlD,OAAMmD,SACJzE,EAAA0B,QAAMC,IACxB,wDACiD8C,iDAmKnDC,CAAY3D,EAAMG,OAAOC,aAAa,eACnCU,MAAK,SAAUC,GAEdd,QAAQC,IAAIa,GACZd,QAAQC,IAAIa,EAASE,KAAK2C,MAAM,GAAGpD,GAAGqD,SAvI5C,SAA4B9C,GAC1B,MAAMC,EAAQD,EAASE,KACvB6C,qBAAuB,CACrBC,OAAQ/C,EAAM4C,MAAM,GAAGpD,GAAGqD,SAE5B5D,QAAQC,IAAI4D,qBACd,CAkIME,CAAmBjD,GA9HzB,SAAqB2C,GAGnB,IAFA,IAgBQO,EAhBJC,EAAU9E,SAASW,iBAAiB,YAE/BoE,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAAK,CAEvC,IAAIE,EAAS,8BAAgCX,EAAI,iBAE7CJ,EAAQ,IAAIgB,MAChBhB,EAAMiB,IAAMF,EACZf,EAAMkB,iBACJ,YAEEN,EAAQC,GAAGM,YAAYnB,IAKrBW,YAAS7E,SAASsF,cAAc,WAC7BC,aAAa,kBAAmB,IACvCV,EAAOU,aAAa,cAAe,KACnCV,EAAOU,aAAa,MAAO,iCAAmCjB,EAAI,qBAClEQ,EAAQC,GAAG7D,UAAY,GACvB4D,EAAQC,GAAGM,YAAYR,EAG3B,CACF,CAqGMW,CAAYd,qBAAqBC,OACnC,IACCP,OAAM,SAAUC,GAEfxD,QAAQC,IAAIuD,EACd,IACJ,C","sources":["src/js/movie-details.js"],"sourcesContent":["import axios from 'axios';\nimport { idToGenereTranslate, modalToggle } from './helpers';\n\nconst gallery = document.querySelector('.movie-container');\nconst overview = document.querySelector('.overview');\nconst closeModal = document.querySelector('.modalClose');\nconst API_KEY = '4e9fa3fc2487236fdff94602c5bb9552';\n\nconst watchButton = document.querySelector('.watch');\nconst queueButton = document.querySelector('.que');\n\nconst spinner = document.querySelector('.sk-chase');\nlet exportData;\n\ncloseModal.onclick = modalToggle;\n\nconst fetchProvider = async (id = 1771) => {\n  const table = await axios.get(\n    `\nhttps://api.themoviedb.org/3/movie/${id}/watch/providers?api_key=4e9fa3fc2487236fdff94602c5bb9552`,\n  );\n  console.log(table);\n  return table;\n};\n\nconst fetchGenere = async q => {\n  const table = await axios.get(\n    `\nhttps://youtube.googleapis.com/youtube/v3/search?q=${q}&key=AIzaSyB8TTc_5353cPL4Gqfo9xPQBbRH9hfG-YA`,\n  );\n  return table;\n};\n\nfunction gatherDetailsProv(response) {\n  const table = response.data.results.PL;\n  console.log('test');\n  if (table !== undefined && table.flatrate !== undefined) {\n    // console.log(table.flatrate[0].provider_name.includes === \"Netflix\")\n    console.log(table.flatrate[0].provider_name === 'Netflix');\n    const NMark = `<a href=\"https://www.netflix.com/search?q=${exportData.title}\" target=\"_blank\" rel=\"noreferrer noopener\"><image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${table.flatrate[0].logo_path}\" width=\"50\" height=\"50\"></a>   \n   `;\n\n    const markupList = table.flatrate\n      .filter(image => image.provider_name !== 'Netflix')\n      .map(\n        image => `<image class=\"stream\" src=\"https://www.themoviedb.org/t/p/original${image.logo_path}\" width=\"50\" height=\"50\">   \n   `,\n      )\n      .join(``);\n    overview.insertAdjacentHTML('beforeend', `<p class=\"mod-ab\">STREAM</p>`);\n    if (table.flatrate[0].provider_name === 'Netflix') {\n      overview.insertAdjacentHTML('beforeend', NMark);\n    }\n    overview.insertAdjacentHTML('beforeend', markupList);\n    document.querySelector('.mod--buttons').classList.remove('mod--buttons-alt');\n  } else {\n    document.querySelector('.mod--buttons').classList.add('mod--buttons-alt');\n  }\n}\n\nfunction gatherDetailsForYt(response) {\n  const table = response.data;\n  detailsObjectYouTube = {\n    snipet: table.items[0].id.videoId,\n  };\n  console.log(detailsObjectYouTube);\n}\n\nvar vplayer = document.querySelectorAll('.vplayer');\n\nfunction YoutubeLoad(q) {\n  var vplayer = document.querySelectorAll('.vplayer');\n\n  for (var i = 0; i < vplayer.length; i++) {\n    // console.log(vplayer[i].dataset.v);\n    var source = 'https://img.youtube.com/vi/' + q + '/sddefault.jpg';\n\n    var image = new Image();\n    image.src = source;\n    image.addEventListener(\n      'load',\n      (function () {\n        vplayer[i].appendChild(image);\n      })(i),\n    );\n\n    function LoadYT() {\n      var iframe = document.createElement('iframe');\n      iframe.setAttribute('allowfullscreen', '');\n      iframe.setAttribute('frameborder', '0');\n      iframe.setAttribute('src', 'https://www.youtube.com/embed/' + q + '?rel=0&showinfo=0');\n      vplayer[i].innerHTML = '';\n      vplayer[i].appendChild(iframe);\n    }\n    LoadYT();\n  }\n}\n\n// Zapytanie do API TMDB zwraca obiekt odpowiedzi\nconst fetchDetails = async (id = 1771) => {\n  spinner.classList.remove('hidden');\n  const table = await axios.get(`\n\nhttps://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=en-US`);\n  return table;\n};\n\n// Renderowanie zawartości modala\nfunction renderDetails(response) {\n  const table = response.data;\n  exportData = response.data;\n  console.log(table);\n\n  const markupList = `<div class=\"mod-div-img\"><image class=\"mod-img\" src=\"https://image.tmdb.org/t/p/w500${\n    table.poster_path\n  }\"><div><h2 class=\"mod-title\">${table.title.toUpperCase()}</h2>\n  <div class=\"row\">\n<div class = \"columnA\">\n  <p class=\"space\">Vote / Votes</p>\n  <p class=\"space\">Popularity</p>\n  <p class=\"space\">Original Title</p>\n  <p class=\"space\">Genre</p>\n  </div>\n     <div class = \"columnB\">\n     <p class=\"space\"><span class=\"vote-mod\">${table.vote_average.toFixed(\n       1,\n     )}</span> / <span class=\"votes-mod\">${table.vote_count}</p>\n     <p class=\"space\">${table.popularity.toFixed(1)}</p></b>\n     <p class=\"space\">${table.original_title.toUpperCase()}</p>\n     <p class=\"space\">${table.genres.map(element => idToGenereTranslate(element.id)).join(`, `)}  \n     </p> \n     </div></div>  \n  <h3 class=\"mod-about\">ABOUT</h3>\n      <p class=\"mod-about-content\">${table.overview}</p>\n  `;\n  overview.insertAdjacentHTML(\n    'afterbegin',\n    markupList.replaceAll(\n      'https://image.tmdb.org/t/p/w500null',\n      'https://mateuszwoj-bit.github.io/GOIT-team-project-ice/squoosh-how1-desktop.b9f13a59.png',\n    ),\n  );\n  spinner.classList.add('hidden');\n}\n\n//Pobiera informacje z atrybutów plakatu filmu (IMG)\nfunction handleDetailClick(event) {\n  console.log(event.target.getAttribute('movieID'));\n  console.log(event.target.getAttribute('movietitle'));\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  overview.innerHTML = '';\n  modalToggle();\n  fetchDetails(event.target.getAttribute('movieID'))\n    .then(function (response) {\n      // handle success\n      renderDetails(response);\n      watchButton.innerHTML = 'ADD TO WATCHED';\n      watchButton.classList.remove('btn-mod-color');\n      queueButton.innerHTML = 'ADD TO QUEUE';\n      queueButton.classList.remove('btn-mod-color');\n      console.log(exportData.title);\n      const parsedWatch = JSON.parse(localStorage.getItem('WATCH_KEY'));\n      const parsedQue = JSON.parse(localStorage.getItem('QUEUE_KEY'));\n      if (parsedWatch.find(movie => movie.title === exportData.title)) {\n        watchButton.innerHTML = 'ADDED TO WATCHED';\n        watchButton.classList.add('btn-mod-color');\n      }\n      if (parsedQue.find(movie => movie.title === exportData.title)) {\n        queueButton.innerHTML = 'ADDED TO QUEUE';\n        queueButton.classList.add('btn-mod-color');\n      }\n    })\n    .then(\n      fetchProvider(event.target.getAttribute('movieID'))\n        .then(function (response) {\n          // handle success\n          console.log('prov');\n          console.log(response);\n          gatherDetailsProv(response);\n        })\n        .catch(function (error) {\n          // handle error\n          console.log(error);\n        }),\n    )\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n  fetchGenere(event.target.getAttribute('movietitle'))\n    .then(function (response) {\n      // handle success\n      console.log(response);\n      console.log(response.data.items[0].id.videoId);\n      gatherDetailsForYt(response);\n      YoutubeLoad(detailsObjectYouTube.snipet);\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    });\n}\n\ngallery.onclick = handleDetailClick;\nexport { exportData };\n"],"names":["$fmRoT","parcelRequire","$d12d61fe1941ad07$var$gallery","document","querySelector","$d12d61fe1941ad07$var$overview","$d12d61fe1941ad07$var$closeModal","$d12d61fe1941ad07$var$watchButton","$d12d61fe1941ad07$var$queueButton","$d12d61fe1941ad07$var$spinner","$d12d61fe1941ad07$export$5e3bc6f9d5e187a3","onclick","$ge6e3","modalToggle","querySelectorAll","event","console","log","target","getAttribute","nodeName","innerHTML","async","id","classList","remove","default","get","$d12d61fe1941ad07$var$fetchDetails","then","response","table","data","markupList","poster_path","title","toUpperCase","vote_average","toFixed","vote_count","popularity","original_title","genres","map","element","idToGenereTranslate","join","overview","insertAdjacentHTML","replaceAll","add","$d12d61fe1941ad07$var$renderDetails","parsedWatch","JSON","parse","localStorage","getItem","parsedQue","find","movie","$d12d61fe1941ad07$var$fetchProvider","results","PL","undefined","flatrate","provider_name","NMark","logo_path","filter","image","$d12d61fe1941ad07$var$gatherDetailsProv","catch","error","q","$d12d61fe1941ad07$var$fetchGenere","items","videoId","detailsObjectYouTube","snipet","$d12d61fe1941ad07$var$gatherDetailsForYt","iframe","vplayer","i","length","source","Image","src","addEventListener","appendChild","createElement","setAttribute","$d12d61fe1941ad07$var$YoutubeLoad"],"version":3,"file":"index.aa6e1747.js.map"}